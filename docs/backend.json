{
  "entities": {
    "BlogPost": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BlogPost",
      "type": "object",
      "description": "Represents a blog post entry.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the BlogPost entity."
        },
        "title": {
          "type": "string",
          "description": "The title of the blog post."
        },
        "content": {
          "type": "string",
          "description": "The full content of the blog post in Markdown format."
        },
        "category": {
          "type": "string",
          "description": "The category of the blog post."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the main image for the blog post."
        },
        "imageHint": {
          "type": "string",
          "description": "A hint for AI to find a relevant image."
        },
        "excerpt": {
          "type": "string",
          "description": "A short summary or excerpt of the blog post."
        },
        "authorId": {
          "type": "string",
          "description": "The ID of the user who authored the post."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The date and time the blog post was created."
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "The date and time the blog post was last updated."
        }
      },
      "required": ["id", "title", "content", "authorId", "createdAt", "updatedAt"]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile in the EnTrans application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity."
        },
        "firstName": {
          "type": "string",
          "description": "The user's first name."
        },
        "lastName": {
          "type": "string",
          "description": "The user's last name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The role of the user, which determines their access level.",
          "enum": ["administrador", "treballador", "client/proveidor", "extern"]
        },
        "creationDate": {
          "type": "string",
          "description": "The date and time the user profile was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "role"
      ]
    },
    "RegistrationRequest": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "RegistrationRequest",
        "type": "object",
        "description": "Represents a request for a new user account.",
        "properties": {
            "id": { "type": "string", "description": "Unique ID for the request." },
            "firstName": { "type": "string" },
            "lastName": { "type": "string" },
            "email": { "type": "string", "format": "email" },
            "status": { "type": "string", "enum": ["pending"] },
            "requestedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["firstName", "lastName", "email", "status", "requestedAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. The 'userId' parameter is the Firebase Auth UID.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Auth UID of the user."
            }
          ]
        }
      },
      {
          "path": "/registrationRequests/{requestId}",
          "definition": {
              "entityName": "RegistrationRequest",
              "schema": { "$ref": "#/backend/entities/RegistrationRequest" },
              "description": "Stores new user registration requests pending admin approval."
          }
      },
      {
        "path": "/blogPosts/{blogPostId}",
        "definition": {
          "entityName": "BlogPost",
          "schema": {
            "$ref": "#/backend/entities/BlogPost"
          },
          "description": "Stores blog post articles.",
          "params": [
            {
              "name": "blogPostId",
              "description": "The unique ID of the blog post."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure has been simplified to support the core features of the EnTrans application. User profiles are stored under /users/{userId} for clear ownership. Registration requests are in a top-level collection for admin review. Blog posts are in their own collection, publicly readable. The previous, more complex structure for transport requests, offerings, and matches has been removed to align with the new, simplified application flow that uses an external SheetDB for order management."
  }
}
